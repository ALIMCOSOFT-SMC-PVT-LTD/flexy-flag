<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flexi-Flags Visual Test - Real SVG Files</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .flag-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }
      .flag-item {
        text-align: center;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background: #f9f9f9;
      }
      .flag-svg {
        width: 120px;
        height: 80px;
        border: 1px solid #ccc;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .flag-svg img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
      }
      .shapes-demo {
        display: flex;
        gap: 15px;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        flex-wrap: wrap;
      }
      .shape-item {
        text-align: center;
      }
      .shape-flag {
        width: 80px;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
        /* Add a border to clearly see the container's shape */
        border: 1px solid #ddd;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        /* The height will be determined by the aspect-ratio of each shape class */
      }
      .rectangle {
        aspect-ratio: 3/2;
      }
      .square {
        aspect-ratio: 1/1;
      }
      .circle {
        aspect-ratio: 1/1;
        border-radius: 50%;
        overflow: hidden;
      }
      .rounded {
        aspect-ratio: 3/2;
        border-radius: 8px;
        overflow: hidden;
      }
      .pill {
        aspect-ratio: 3/2;
        border-radius: 999px; /* A large value creates a perfect pill shape */
        overflow: hidden;
      }

      h1 {
        color: #333;
        text-align: center;
      }
      h2 {
        color: #666;
        border-bottom: 2px solid #eee;
        padding-bottom: 5px;
      }
      .stats {
        background: #e3f2fd;
        padding: 15px;
        border-radius: 6px;
        margin: 20px 0;
      }
      .error {
        color: #d32f2f;
        font-size: 12px;
        margin-top: 5px;
      }
      .loading {
        color: #1976d2;
        font-size: 12px;
      }
      .success {
        color: #388e3c;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üèÅ Flexi-Flags Visual Test - Real SVG Files</h1>

      <div class="stats">
        <h3>üìä Package Statistics</h3>
        <p><strong>Total Countries:</strong> 252</p>
        <p>
          <strong>SVG Files Available:</strong>
          <span id="svg-count">Loading...</span>
        </p>
        <p>
          <strong>Test Countries:</strong>
          <span id="test-countries">Loading...</span>
        </p>
      </div>

      <h2>üé® Real SVG Flags from Assets Directory</h2>
      <div class="flag-grid" id="real-flags">
        <!-- Will be populated by JavaScript -->
      </div>

      <h2>üîÑ Shape Examples (US Flag)</h2>
      <div class="shapes-demo">
        <div class="shape-item">
          <div class="shape-flag rectangle" id="shape-rectangle">
            <span class="loading">Loading...</span>
          </div>
          <p>Rectangle</p>
        </div>
        <div class="shape-item">
          <div class="shape-flag square" id="shape-square">
            <span class="loading">Loading...</span>
          </div>
          <p>Square</p>
        </div>
        <div class="shape-item">
          <div class="shape-flag circle" id="shape-circle">
            <span class="loading">Loading...</span>
          </div>
          <p>Circle</p>
        </div>
        <div class="shape-item">
          <div class="shape-flag rounded" id="shape-rounded">
            <span class="loading">Loading...</span>
          </div>
          <p>Rounded</p>
        </div>
        <div class="shape-item">
          <div class="shape-flag pill" id="shape-pill">
            <span class="loading">Loading...</span>
          </div>
          <p>Pill</p>
        </div>
      </div>

      <h2>üìù Test Different Countries</h2>
      <div class="flag-grid" id="test-flags">
        <!-- Will be populated by JavaScript -->
      </div>
    </div>

    <script>
      // Test countries to load from assets
      const testCountries = [
        { code: 'us', name: 'United States' },
        { code: 'gb', name: 'United Kingdom' },
        { code: 'ca', name: 'Canada' },
        { code: 'de', name: 'Germany' },
        { code: 'fr', name: 'France' },
        { code: 'jp', name: 'Japan' },
        { code: 'in', name: 'India' },
        { code: 'br', name: 'Brazil' },
        { code: 'au', name: 'Australia' },
        { code: 'ch', name: 'Switzerland' },
        { code: 'za', name: 'South Africa' },
        { code: 'zw', name: 'Zimbabwe' },
      ];

      let loadedFlags = 0;
      let totalFlags = testCountries.length;

      // Function to load SVG file
      async function loadSvgFile(countryCode) {
        try {
          const response = await fetch(`src/assets/flags/${countryCode}.svg`);
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          const svgText = await response.text();
          loadedFlags++;
          updateStats();
          return svgText;
        } catch (error) {
          console.error(`Failed to load ${countryCode}.svg:`, error);
          return null;
        }
      }

      // Function to update statistics
      function updateStats() {
        document.getElementById('svg-count').textContent =
          `${loadedFlags}/${totalFlags} loaded`;
        document.getElementById('test-countries').textContent = testCountries
          .map(c => c.code.toUpperCase())
          .join(', ');
      }

      // Function to create flag item
      function createFlagItem(country, svgContent = null) {
        const item = document.createElement('div');
        item.className = 'flag-item';

        if (svgContent) {
          item.innerHTML = `
                    <div class="flag-svg">${svgContent}</div>
                    <h4>${country.name}</h4>
                    <p><code>${country.code.toUpperCase()}</code></p>
                    <span class="success">‚úÖ SVG loaded successfully</span>
                `;
        } else {
          item.innerHTML = `
                    <div class="flag-svg">
                        <div style="background: #f0f0f0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #666;">
                            <span>${country.code.toUpperCase()}</span>
                        </div>
                    </div>
                    <h4>${country.name}</h4>
                    <p><code>${country.code.toUpperCase()}</code></p>
                    <span class="error">‚ùå SVG file not found</span>
                `;
        }

        return item;
      }

      // Load and display real flags
      async function loadRealFlags() {
        const container = document.getElementById('real-flags');

        for (const country of testCountries) {
          const svgContent = await loadSvgFile(country.code);
          const item = createFlagItem(country, svgContent);
          container.appendChild(item);
        }
      }

      // Load test flags for different countries
      async function loadTestFlags() {
        const container = document.getElementById('test-flags');

        for (const country of testCountries) {
          const svgContent = await loadSvgFile(country.code);
          if (svgContent) {
            const item = createFlagItem(country, svgContent);
            container.appendChild(item);
          }
        }
      }

      // Load shape examples with US flag
      async function loadShapeExamples() {
        /**
         * Modifies an SVG string to ensure it fills its container, cropping if necessary.
         * This prevents distortion in non-rectangular shapes like circles and squares.
         */
        function optimizeSvgForShapes(svgContent) {
          if (!svgContent) return '';
          // Use `slice` to make the SVG fill the container.
          return svgContent.replace(
            '<svg',
            '<svg preserveAspectRatio="xMidYMid slice"'
          );
        }

        const usSvg = await loadSvgFile('us');
        if (usSvg) {
          const optimizedSvg = optimizeSvgForShapes(usSvg);
          ['rectangle', 'square', 'circle', 'rounded', 'pill'].forEach(
            shape =>
              (document.getElementById(`shape-${shape}`).innerHTML =
                optimizedSvg)
          );
        }
      }

      // Initialize everything
      async function init() {
        try {
          await loadRealFlags();
          await loadShapeExamples();
          await loadTestFlags();
        } catch (error) {
          console.error('Error initializing:', error);
        }
      }

      // Start loading
      init();
    </script>
  </body>
</html>
