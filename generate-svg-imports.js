const fs = require('fs');
const path = require('path');

const flagsDir = path.join(__dirname, 'src/assets/flags');
const outputFile = path.join(__dirname, 'src/utils/staticSvgMap.ts');

// Get all SVG files
const svgFiles = fs
  .readdirSync(flagsDir)
  .filter(file => file.endsWith('.svg'))
  .sort();

console.log(`Found ${svgFiles.length} SVG files`);

// Generate imports
let imports = '';
let mapEntries = '';

svgFiles.forEach(file => {
  const countryCode = path.basename(file, '.svg');
  // Replace hyphens with underscores for valid variable names
  const varName = `${countryCode.replace(/-/g, '_')}Svg`;

  imports += `import ${varName} from '../assets/flags/${file}';\n`;
  mapEntries += `  '${countryCode}': ${varName},\n`;
});

const content = `// Auto-generated file - do not edit manually
// Generated by generate-svg-imports.js

${imports}
/**
 * Static mapping of all SVG flags
 */
export const staticSvgMap: Record<string, string> = {
${mapEntries}};

/**
 * Get SVG content from static mapping
 */
export function getStaticSvg(countryCode: string): string | null {
  return staticSvgMap[countryCode.toLowerCase()] || null;
}
`;

fs.writeFileSync(outputFile, content);
console.log(`Generated ${outputFile} with ${svgFiles.length} SVG imports`);
